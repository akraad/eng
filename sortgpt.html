<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù„ØºØ§Øª</title>
  <style>
    body {
      font-family: sans-serif;
      direction: rtl;
      padding: 20px;
      background-color: #f4f4f4;
    }
    input, button {
      font-size: 16px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>ğŸ“„ Ø§Ù†ØªØ®Ø§Ø¨ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ØªÙ†ÛŒ (Ø­Ø¯Ø§Ú©Ø«Ø± Ûµ ÙØ§ÛŒÙ„ txt)</h2>
  <input type="file" id="fileInput" multiple accept=".txt">
  <br><br>
  <button onclick="processFiles()">ğŸ” Ù¾Ø±Ø¯Ø§Ø²Ø´ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù„ÛŒØ³Øª Ù†Ù‡Ø§ÛŒÛŒ</button>

  <script>
    function cleanWord(word) {
      return word
        .toLowerCase()                // lowercase
        .replace(/[\u0600-\u06FF]/g, '') // Ø­Ø°Ù Ø­Ø±ÙˆÙ ÙØ§Ø±Ø³ÛŒ
        .replace(/[^a-z\-']/g, '')    // Ø­Ø°Ù Ù‡Ù…Ù‡â€ŒÚ†ÛŒØ² Ø¨Ù‡â€ŒØ¬Ø² Ø­Ø±ÙˆÙ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒØŒ Ø®Ø· ØªÛŒØ±Ù‡ØŒ Ø¢Ù¾ÙˆØ³ØªØ±ÙˆÙ
        .trim();                      // Ø­Ø°Ù ÙØ§ØµÙ„Ù‡ Ø§Ø¶Ø§ÙÛŒ
    }

    function processFiles() {
      const input = document.getElementById('fileInput');
      const files = input.files;

      if (files.length === 0) {
        alert('Ù„Ø·ÙØ§Ù‹ Ø­Ø¯Ø§Ù‚Ù„ ÛŒÚ© ÙØ§ÛŒÙ„ txt Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
        return;
      }

      if (files.length > 5) {
        alert('Ø­Ø¯Ø§Ú©Ø«Ø± Ûµ ÙØ§ÛŒÙ„ Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„ Ø§Ø³Øª.');
        return;
      }

      const allTextPromises = [];

      for (let i = 0; i < files.length; i++) {
        allTextPromises.push(files[i].text());
      }

      Promise.all(allTextPromises).then(contents => {
        const wordSet = new Set();

        contents.forEach(text => {
          const rawWords = text.split(/\s+/);

          rawWords.forEach(raw => {
            const cleaned = cleanWord(raw);
            if (cleaned.length > 0 && /^[a-z]/.test(cleaned)) {
              wordSet.add(cleaned);
            }
          });
        });

        const sorted = Array.from(wordSet).sort((a, b) => a.localeCompare(b));
        const numbered = sorted.map((w, i) => `${i + 1}. ${w}`);
        const outputText = numbered.join('\n');

        const blob = new Blob([outputText], { type: 'text/plain;charset=utf-8' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'unique_sorted_words.txt';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
    }
  </script>
</body>
</html>
