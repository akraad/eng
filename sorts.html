<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>استخراج کلمات از فایل</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #output { white-space: pre; border: 1px solid #ccc; padding: 10px; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>استخراج کلمات از فایل .txt</h2>
  <input type="file" id="fileInput" accept=".txt">
  <button onclick="processFile()">پردازش فایل</button>
  <button onclick="downloadOutput()">دانلود خروجی</button>

  <h3>خروجی:</h3>
  <div id="output"></div>

  <script>
    let resultText = "";

    function processFile() {
      const file = document.getElementById("fileInput").files[0];
      if (!file) {
        alert("لطفاً یک فایل انتخاب کنید");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        const lines = e.target.result.split("\n");
        const output = [];
        let count = 1;

        for (let line of lines) {
          line = line.trim();
          if (line === "" || !line.includes(" - ")) continue;

          const parts = line.split(" - ");
          const lastPart = parts[parts.length - 1];
          const wordMatch = lastPart.match(/^([^\s]+)\s*\(/); // واژه قبل از پرانتز

          if (wordMatch && wordMatch[1]) {
            output.push(`S${count} ${wordMatch[1]}`);
            count++;
          }
        }

        resultText = output.join("\n");
        document.getElementById("output").textContent = resultText;
      };

      reader.readAsText(file);
    }

    function downloadOutput() {
      if (!resultText) {
        alert("ابتدا فایل را پردازش کنید");
        return;
      }

      const blob = new Blob([resultText], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = "output.txt";
      link.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
