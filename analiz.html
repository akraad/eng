<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>تحلیل لغات بر اساس فرمت مشخص</title>
  <style>
    body { font-family: sans-serif; direction: rtl; background: #f9f9f9; padding: 20px; }
    .result { margin-top: 20px; padding: 10px; background: #fff; border: 1px solid #ccc; }
  </style>
</head>
<body>

<h2>آپلود فایل لغات با فرمت مشخص</h2>
<p>فرمت باید این‌طور باشه: <code>ID2 - B2 - XV3 - Q4 - abandon (رها کردن، ترک کردن)</code></p>
<input type="file" id="fileInput" accept=".txt">
<div class="result" id="output"></div>

<script>
document.getElementById('fileInput').addEventListener('change', function(e) {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(event) {
    const lines = event.target.result.split('\n').map(line => line.trim()).filter(Boolean);
    analyzeLines(lines);
  };
  reader.readAsText(file);
});

function analyzeLines(lines) {
  const levelCounts = { A1:0, A2:0, B1:0, B2:0, C1:0, C2:0 };
  const freqCounts  = { XV1:0, XV2:0, XV3:0, XV4:0, XV5:0, XV6:0 };
  const typeCounts  = { Q1:0, Q2:0, Q3:0, Q4:0, Q5:0, Q6:0, Q7:0, Q8:0 };

  lines.forEach(line => {
    const parts = line.split(' - ');
    if (parts.length >= 5) {
      const level = parts[1].trim();
      const freq = parts[2].trim();
      const type = parts[3].trim();

      if (levelCounts.hasOwnProperty(level)) levelCounts[level]++;
      if (freqCounts.hasOwnProperty(freq)) freqCounts[freq]++;
      if (typeCounts.hasOwnProperty(type)) typeCounts[type]++;
    }
  });

  let html = `<h3>نتایج تحلیل</h3>`;
  html += `<b>تعداد کل خطوط پردازش شده:</b> ${lines.length}<br><br>`;

  html += `<b>تعداد کلمات بر اساس سطح (CEFR):</b><ul>`;
  for (let level in levelCounts) {
    html += `<li>یک کلمه سطح ${level}: ${levelCounts[level]} مورد</li>`;
  }
  html += `</ul>`;

  html += `<b>تعداد کلمات بر اساس میزان رایج بودن:</b><ul>`;
  const freqLabels = {
    XV1: "واژگان خیلی پرکاربرد",
    XV2: "واژگان پرکاربرد",
    XV3: "واژگان رایج",
    XV4: "واژگان نیمه‌پیشرفته",
    XV5: "واژگان کم‌کاربرد",
    XV6: "واژگان نادر یا تخصصی"
  };
  for (let freq in freqCounts) {
    html += `<li>یک کلمه از ${freqLabels[freq]} (${freq}): ${freqCounts[freq]} مورد</li>`;
  }
  html += `</ul>`;

  html += `<b>تعداد کلمات بر اساس نوع:</b><ul>`;
  const typeLabels = {
    Q1: "noun",
    Q2: "adjective",
    Q3: "pronoun",
    Q4: "verb",
    Q5: "adverb",
    Q6: "preposition",
    Q7: "conjunction",
    Q8: "interjection"
  };
  for (let type in typeCounts) {
    html += `<li>یک کلمه ${typeLabels[type]} (${type}): ${typeCounts[type]} مورد</li>`;
  }
  html += `</ul>`;

  document.getElementById('output').innerHTML = html;
}
</script>

</body>
</html>
